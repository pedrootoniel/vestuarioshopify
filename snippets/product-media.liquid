{%- if media.media_type == 'image' -%}
  <img class="global-media-settings f-a-none"
    srcset="{%- if media.preview_image.width >= 550 -%}{{ media.preview_image | image_url: width: 550 }} 550w,{%- endif -%}
            {%- if media.preview_image.width >= 1100 -%}{{ media.preview_image | image_url: width: 1100 }} 1100w,{%- endif -%}
            {%- if media.preview_image.width >= 1445 -%}{{ media.preview_image | image_url: width: 1445 }} 1445w,{%- endif -%}
            {%- if media.preview_image.width >= 1680 -%}{{ media.preview_image | image_url: width: 1680 }} 1680w,{%- endif -%}
            {%- if media.preview_image.width >= 2048 -%}{{ media.preview_image | image_url: width: 2048 }} 2048w,{%- endif -%}
            {%- if media.preview_image.width >= 2200 -%}{{ media.preview_image | image_url: width: 2200 }} 2200w,{%- endif -%}
            {%- if media.preview_image.width >= 2890 -%}{{ media.preview_image | image_url: width: 2890 }} 2890w,{%- endif -%}
            {%- if media.preview_image.width >= 4096 -%}{{ media.preview_image | image_url: width: 4096 }} 4096w,{%- endif -%}
            {{ media.preview_image | image_url }} {{ media.preview_image.width }}w"
    sizes="(min-width: 750px) calc(100vw - 22rem), 1100px"
    src="{{ media.preview_image | image_url: width: 1445 }}"
    alt="{{ media.alt | escape }}"
    loading="lazy"
    width="1100"
    height="{{ 1100 | divided_by: media.preview_image.aspect_ratio | ceil }}"
    data-media-id="{{ media.id }}"
  >
{%- else -%}
  {%- if media.media_type == 'model' -%}
    <div class="product-media-modal__model w-100" data-media-id="{{ media.id }}">
      <product-model class="deferred-media media media--ratio media--transparent global-media-settings global-media-settings--no-shadow pos-relative o-h d-block w-100" style="--ratio: {{ media.aspect_ratio | default: 1.0 }};">
  {%- else -%}
    <deferred-media class="deferred-media media media--ratio media--transparent global-media-settings global-media-settings--no-shadow pos-relative o-h d-block w-100" style="--ratio: {{ media.aspect_ratio | default: 1.0 }};" data-media-id="{{ media.id }}">
  {%- endif -%}
    <button id="Deferred-Poster-Modal-{{ media.id }}" class="deferred-media__poster o-h t-button b-none c-pointer p-0 m-0 w-100 h-100 d-block pos-absolute top-0 left-0" type="button">
      <span class="deferred-media__poster-button pos-absolute pos-absolute-c-c z-index-1 b-circle d-flex a-i-center j-c-center c-pointer gradient gradient-global motion-reduce">
        {%- liquid
          case media.media_type
          when 'video' or 'external_video'
            render 'icon-play'
          when 'model'
            render 'icon-3d-model'
          endcase
        -%}
      </span>
      {{ media.preview_image | image_url: width: 1946 | image_tag:
        class: 'o-h',
        loading: lazy,
        sizes: sizes,
        widths: '246, 493, 600, 713, 823, 990, 1100, 1206, 1346, 1426, 1646, 1946'
      }}
    </button>
    <template>
      {%- liquid
        case media.media_type
        when 'external_video'
          assign video_class = 'd-block pos-absolute top-0 left-0 w-100 h-100 js-' | append: media.host
          if media.host == 'youtube'
            echo media | external_video_url: autoplay: true, loop: loop, playlist: media.external_id | external_video_tag: class: video_class, loading: "lazy"
          else
            echo media | external_video_url: autoplay: true, loop: loop | external_video_tag: class: video_class, loading: "lazy"
          endif
        when 'video'
          echo media | media_tag: image_size: "2048x", autoplay: true, loop: loop, controls: true, preload: "none"
        when 'model'
          echo media | media_tag: image_size: "2048x", toggleable: true
        endcase
      -%}
    </template>
  {%- if media.media_type == 'model' -%}
      </product-model>
      <button
        class="button product__xr-button"
        type="button"
        aria-label="{{ 'products.product.xr_button_label' | t }}"
        data-shopify-xr
        data-shopify-model3d-id="{{ media.id }}"
        data-shopify-title="title"
        data-shopify-xr-hidden
        >
        {% render 'icon-3d-model' %}
        {{ 'products.product.xr_button' | t }}
      </button>
    </div>
  {%- else -%}
    </deferred-media>
  {%- endif -%}
{%- endif -%}
